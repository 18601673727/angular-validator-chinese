(function(){var p,g,q;p=angular.element;g=angular.module("validator.directive",["validator.provider"]);q=function(g){return{restrict:"A",require:"ngModel",link:function(h,d,c){var a,b,m,f,e,k,l,n;a=g.get("$validator");m=g.get("$parse")(c.ngModel);e=[];k=function(a,b){var n,k,f,g,l;k=0;l=[];f=0;for(g=e.length;f<g;f++){n=e[f];switch(a){case "blur":if("blur"!==n.invoke)continue;n.enableError=!0;break;case "watch":if("watch"!==n.invoke&&!n.enableError)continue;break;case "broadcast":n.enableError=!0}m.assign(h,
n.filter(m(h)));l.push(n.validator(m(h),h,d,c,{success:function(){if(++k===e.length)return n.success(h,d,c),null!=b?b.success():void 0},error:function(){n.enableError&&n.error(h,d,c);if(1===(null!=b?b.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(d).offset().top-100},500):d[0].scrollIntoViewIfNeeded()}}))}return l};if(b=c.validator.match(/^\/(.*)\/$/))f=a.convertRule("dynamic",{validator:RegExp(b[1]),invoke:c.validatorInvoke,error:c.validatorError}),e.push(f);
if(b=c.validator.match(/^\[(.*)\]$/))for(b=b[1].split(","),l=0,n=b.length;l<n;l++)f=b[l],(f=a.getRule(f.trim()))&&e.push(f);h.$on(a.broadcastChannel.prepare,function(a,b){if(!b.model||0===c.ngModel.indexOf(b.model))return b.accept()});h.$on(a.broadcastChannel.start,function(a,b){if(!b.model||0===c.ngModel.indexOf(b.model))return k("broadcast",{success:b.success,error:b.error})});h.$watch(c.ngModel,function(a,b){if(a!==b)return k("watch")});return p(d).bind("blur",function(){return h.$apply(function(){return k("blur")})})}}};
q.$inject=["$injector"];g.directive("validator",q)}).call(this);(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var p;p=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var g,q,r,h=this;r=q=g=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart"};this.setupProviders=function(d){g=d;q=g.get("$q");return r=g.get("$timeout")};this.convertError=function(d){var c;if("function"===typeof d)return d;c=d.constructor===String?d:"";return function(a,b,d){for(a=p(b).parent();0!==a.length;){if(a.hasClass("form-group")){if(a.hasClass("has-error"))break;
p(b).parent().append("<label for='"+d.id+"' class='control-label error'>"+c+"</label>");a.addClass("has-error");break}a=a.parent()}}};this.convertSuccess=function(d){return"function"===typeof d?d:function(d,a){var b,m,f,e,k;b=p(a).parent();for(k=[];0!==b.length;){if(b.hasClass("has-error")){b.removeClass("has-error");e=b.find("label");m=0;for(f=e.length;m<f;m++)if(b=e[m],p(b).hasClass("error")){b.remove();break}break}k.push(b=b.parent())}return k}};this.convertValidator=function(d){var c;c=function(){};
d.constructor===RegExp?c=function(a,b,c,f,e){return d.test(a)?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0}:"function"===typeof d&&(c=function(a,b,c,f,e){return q.all([d(a,b,c,f,g)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0},function(){return"function"===typeof e.error?e.error():void 0})});return c};this.convertRule=function(d,c){var a;null==c&&(c={});a=
{name:d,enableError:"watch"===c.invoke,invoke:c.invoke,filter:c.filter,validator:c.validator,error:c.error,success:c.success};null==a.filter&&(a.filter=function(a){return a});null==a.validator&&(a.validator=function(){return!0});null==a.error&&(a.error="");a.error=h.convertError(a.error);a.success=h.convertSuccess(a.success);a.validator=h.convertValidator(a.validator);return a};this.register=function(d,c){null==c&&(c={});return this.rules[d]=this.convertRule(d,c)};this.getRule=function(d){return this.rules[d]?
this.rules[d]:null};this.validate=function(d,c){var a,b,m,f,e,k,l;l=q.defer().promise;e=f=m=0;a=[];b=[];l.success=function(b){a.push(b);return l};l.error=function(a){b.push(a);return l};k={model:c,accept:function(){return m++},success:function(){var b,d,c;if(++f===m)for(d=0,c=a.length;d<c;d++)b=a[d],b()},error:function(){var a,d,c;if(0===e++)for(d=0,c=b.length;d<c;d++)a=b[d],a();return e}};d.$broadcast(h.broadcastChannel.prepare,k);r(function(){var b,c,e;if(0===m)for(c=0,e=a.length;c<e;c++)b=a[c],
b();else return b=g.get("$validator"),d.$broadcast(b.broadcastChannel.start,k)});return l};this.get=function(d){this.setupProviders(d);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
