(function(){var m,n,p;m=angular.element;n=angular.module("validator.directive",["validator.provider"]);p=function(n){return{restrict:"A",require:"ngModel",link:function(h,a,c){var f,e,g,d,b,k,l,r,q,s,p;f=n.get("$validator");d=n.get("$parse")(c.ngModel);r=[];q=function(f,e){var b,g,k,q,l;g=0;l=[];k=0;for(q=r.length;k<q;k++){b=r[k];switch(f){case "blur":if("blur"!==b.invoke)continue;b.enableError=!0;break;case "watch":if("watch"!==b.invoke&&!b.enableError)continue;break;case "broadcast":b.enableError=
!0}d.assign(h,b.filter(d(h)));l.push(b.validator(d(h),h,a,c,{success:function(){if(++g===r.length)return b.success(h,a,c),null!=e?e.success():void 0},error:function(){b.enableError&&b.error(h,a,c);if(1===(null!=e?e.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(a).offset().top-100},500):a[0].scrollIntoViewIfNeeded()}}))}return l};if(g=c.validator.match(/^\/(.*)\/$/))k=f.convertRule("dynamic",{validator:RegExp(g[1]),invoke:c.validatorInvoke,error:c.validatorError}),
r.push(k);if(g=c.validator.match(/^\[(.*)\]$/))for(l=g[1].split(","),s=0,p=l.length;s<p;s++)b=l[s],(k=f.getRule(b.replace(/^\s+|\s+$/g,"")))&&r.push(k);e=function(b,f){var e,d;if(f){if(b.targetScope===h)return 0===c.ngModel.indexOf(f);for(e=m(a);0!==e.length;){d=e.attr("ng-repeat");if((g=null!=d?d.match(/^.* in (.*)$/):void 0)&&0<=g[1].indexOf(f))return!0;e=e.parent()}return!1}return!0};h.$on(f.broadcastChannel.prepare,function(b,a){if(e(b,a.model))return a.accept()});h.$on(f.broadcastChannel.start,
function(b,a){if(e(b,a.model))return q("broadcast",{success:a.success,error:a.error})});h.$on(f.broadcastChannel.reset,function(b,f){var d,g,q;if(e(b,f.model)){q=[];d=0;for(g=r.length;d<g;d++)k=r[d],q.push(k.success(h,a,c));return q}});h.$watch(c.ngModel,function(b,a){if(b!==a)return q("watch")});return m(a).bind("blur",function(){return h.$apply(function(){return q("blur")})})}}};p.$inject=["$injector"];n.directive("validator",p)}).call(this);
(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var m;m=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var n,p,t,h=this;t=p=n=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart",reset:"$validateReset"};this.setupProviders=function(a){n=a;p=n.get("$q");return t=n.get("$timeout")};this.convertError=function(a){var c;if("function"===typeof a)return a;c=a.constructor===String?a:"";return function(a,e,g){var d,b,k,h;d=m(e).parent();for(a=[];0!==d.length;){if(d.hasClass("form-group")){d.addClass("has-error");
h=d.find("label");b=0;for(k=h.length;b<k;b++)d=h[b],m(d).hasClass("error")&&m(d).remove();d=m("<label class='control-label error'>"+c+"</label>");g.id&&d.attr("for",g.id);m(e).parent().append(d);break}a.push(d=d.parent())}return a}};this.convertSuccess=function(a){return"function"===typeof a?a:function(a,f){var e,g,d,b,k;e=m(f).parent();for(k=[];0!==e.length;){if(e.hasClass("has-error")){e.removeClass("has-error");b=e.find("label");g=0;for(d=b.length;g<d;g++)e=b[g],m(e).hasClass("error")&&m(e).remove();
break}k.push(e=e.parent())}return k}};this.convertValidator=function(a){var c;c=function(){};a.constructor===RegExp?c=function(c,e,g,d,b){return a.test(c)?"function"===typeof b.success?b.success():void 0:"function"===typeof b.error?b.error():void 0}:"function"===typeof a&&(c=function(c,e,g,d,b){return p.all([a(c,e,g,d,n)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof b.success?b.success():void 0:"function"===typeof b.error?b.error():void 0},function(){return"function"===typeof b.error?
b.error():void 0})});return c};this.convertRule=function(a,c){var f,e,g,d;null==c&&(c={});f={name:a,enableError:"watch"===c.invoke,invoke:c.invoke,filter:null!=(e=c.filter)?e:function(a){return a},validator:null!=(g=c.validator)?g:function(){return!0},error:null!=(d=c.error)?d:"",success:c.success};f.error=h.convertError(f.error);f.success=h.convertSuccess(f.success);f.validator=h.convertValidator(f.validator);return f};this.register=function(a,c){null==c&&(c={});return this.rules[a]=this.convertRule(a,
c)};this.getRule=function(a){return this.rules[a]?this.rules[a]:null};this.validate=function(a,c){var f,e,g,d,b,k,l;l=p.defer().promise;b=d=g=0;f=[];e=[];l.success=function(a){f.push(a);return l};l.error=function(a){e.push(a);return l};k={model:c,accept:function(){return g++},success:function(){var a,b,c;if(++d===g)for(b=0,c=f.length;b<c;b++)a=f[b],a()},error:function(){var a,c,d;if(0===b++)for(c=0,d=e.length;c<d;c++)a=e[c],a();return b}};a.$broadcast(h.broadcastChannel.prepare,k);t(function(){var b,
c,d;if(0===g)for(c=0,d=f.length;c<d;c++)b=f[c],b();else return b=n.get("$validator"),a.$broadcast(b.broadcastChannel.start,k)});return l};this.reset=function(a,c){return a.$broadcast(h.broadcastChannel.reset,{model:c})};this.get=function(a){this.setupProviders(a);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate,reset:this.reset}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
