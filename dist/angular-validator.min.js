(function(){var n,q,r;n=angular.element;q=angular.module("validator.directive",["validator.provider"]);r=function(p){return{restrict:"A",require:"ngModel",link:function(f,c,d){var a,b,g,s,e,h,k,m,l;b=p.get("$validator");a=p.get("$parse");s=a(d.ngModel);m=[];l=function(u,t){var a,b,e,g,l,h;null==t&&(t={});e=0;a=function(){var b,a,u;if(++e===m.length){a=0;for(u=m.length;a<u;a++)b=m[a],b.success(s(f),f,c,d,p);"function"===typeof t.success&&t.success()}};h=[];g=0;for(l=m.length;g<l;g++){b=m[g];switch(u){case "blur":if("blur"!==
b.invoke)continue;b.enableError=!0;break;case "watch":if("watch"!==b.invoke&&!b.enableError){a();continue}break;case "broadcast":b.enableError=!0}h.push(b.validator(s(f),f,c,d,{success:function(){return a()},error:function(){b.enableError&&b.error(s(f),f,c,d,p);if(1===("function"===typeof t.error?t.error():void 0))try{return c[0].scrollIntoViewIfNeeded()}catch(a){}}}))}return h};h=function(){var a;a=b.getRule("required");null==a&&(a=b.convertRule("required",{validator:/^.+$/,invoke:"watch"}));return m.push(a)};
k=function(a){var b,e,g,l,h;h=[];b=e=0;for(g=m.length;e<g;b=e+=1)(null!=(l=m[b])?l.name:void 0)===a&&(m[b].success(s(f),f,c,d,p),m.splice(b,1),h.push(b--));return h};d.$observe("validator",function(a){var c,g,l,f;m.length=0;(e.validatorRequired||e.required)&&h();if(c=a.match(/^\/(.*)\/$/))g=b.convertRule("dynamic",{validator:RegExp(c[1]),invoke:d.validatorInvoke,error:d.validatorError}),m.push(g);else if(c=a.match(/^\[(.*)\]$/)){a=c[1].split(",");f=[];c=0;for(l=a.length;c<l;c++)g=a[c],(g=b.getRule(g.replace(/^\s+|\s+$/g,
"")))?f.push(m.push(g)):f.push(void 0);return f}});d.$observe("validatorError",function(a){var c;if(c=d.validator.match(/^\/(.*)\/$/))return k("dynamic"),a=b.convertRule("dynamic",{validator:RegExp(c[1]),invoke:d.validatorInvoke,error:a}),m.push(a)});e={validatorRequired:!1,required:!1};d.$observe("validatorRequired",function(a){if(a&&"false"!==a)return h(),e.validatorRequired=!0;if(e.validatorRequired)return k("required"),e.validatorRequired=!1});d.$observe("required",function(a){if(a&&"false"!==
a)return h(),e.required=!0;if(e.required)return k("required"),e.required=!1});g=function(b,c){var e,g;if(c){if(d.validatorGroup===c)return!0;if(b.targetScope===f)return 0===d.ngModel.indexOf(c);e=function(a,b){var c,d;for(c in a)switch(d=a[c],typeof d){case "string":if("$$hashKey"===c&&d===b)return!0;break;case "object":if(e(d,b))return!0}return!1};g=d.ngModel.indexOf(".");g=0<=g?d.ngModel.substr(0,g):d.ngModel;g=a(g)(f);return e(a(c)(b.targetScope),g.$$hashKey)}return!0};f.$on(b.broadcastChannel.prepare,
function(a,b){if(g(a,b.model))return b.accept()});f.$on(b.broadcastChannel.start,function(a,b){if(g(a,b.model))return l("broadcast",{success:b.success,error:b.error})});f.$on(b.broadcastChannel.reset,function(a,b){var e,l,h,k;if(g(a,b.model)){k=[];l=0;for(h=m.length;l<h;l++)e=m[l],k.push(e.success(s(f),f,c,d,p));return k}});f.$watch(d.ngModel,function(a,b){if(a!==b)return l("watch",{oldValue:b})});return n(c).bind("blur",function(){return f.$apply(function(){return l("blur")})})}}};r.$inject=["$injector"];
q.directive("validator",r)}).call(this);(function(){angular.module("validator",["validator.directive"])}).call(this);
(function(){var n;n=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var q,r,p,f=this;p=r=q=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart",reset:"$validateReset"};this.setupProviders=function(c){q=c;r=q.get("$q");return p=q.get("$timeout")};this.convertError=function(c){var d;if("function"===typeof c)return c;d=c.constructor===String?c:"";return function(a,b,c,f){var e,h,k;b=n(c).parent();for(a=[];0!==b.length;){if(b.hasClass("form-group")){b.addClass("has-error");
k=b.find("label");e=0;for(h=k.length;e<h;e++)b=k[e],n(b).hasClass("error")&&n(b).remove();b=n("<label class='control-label error'>"+d+"</label>");f.id&&b.attr("for",f.id);n(c).parent().append(b);break}a.push(b=b.parent())}return a}};this.convertSuccess=function(c){return"function"===typeof c?c:function(c,a,b){var g,f;a=n(b).parent();for(c=[];0!==a.length;){if(a.hasClass("has-error")){a.removeClass("has-error");f=a.find("label");b=0;for(g=f.length;b<g;b++)a=f[b],n(a).hasClass("error")&&n(a).remove();
break}c.push(a=a.parent())}return c}};this.convertValidator=function(c){var d;d=function(){};c.constructor===RegExp?d=function(a,b,d,f,e){null==a&&(a="");return c.test(a)?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0}:"function"===typeof c&&(d=function(a,b,d,f,e){return r.all([c(a,b,d,f,q)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0},function(){return"function"===
typeof e.error?e.error():void 0})});return d};this.convertRule=function(c,d){var a,b,g;null==d&&(d={});a={name:c,enableError:"watch"===d.invoke,invoke:d.invoke,validator:null!=(b=d.validator)?b:function(){return!0},error:null!=(g=d.error)?g:"",success:d.success};a.error=f.convertError(a.error);a.success=f.convertSuccess(a.success);a.validator=f.convertValidator(a.validator);return a};this.register=function(c,d){null==d&&(d={});return this.rules[c]=this.convertRule(c,d)};this.getRule=function(c){return this.rules[c]?
this.rules[c]:null};this.validate=function(c,d){var a,b,g,n,e,h,k;k=r.defer().promise;e=n=g=0;a=[];b=[];k.success=function(b){a.push(b);return k};k.error=function(a){b.push(a);return k};h={model:d,accept:function(){return g++},success:function(){var b,c,d;if(++n===g)for(c=0,d=a.length;c<d;c++)b=a[c],b();return n},error:function(){var a,c,d;if(0===e++)for(c=0,d=b.length;c<d;c++)a=b[c],a();return e}};c.$broadcast(f.broadcastChannel.prepare,h);p(function(){var b,d,e;if(0===g)for(d=0,e=a.length;d<e;d++)b=
a[d],b();else return b=q.get("$validator"),c.$broadcast(b.broadcastChannel.start,h)});return k};this.reset=function(c,d){return c.$broadcast(f.broadcastChannel.reset,{model:d})};this.get=function(c){this.setupProviders(c);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate,reset:this.reset}};this.get.$inject=["$injector"];this.$get=this.get})}).call(this);
