(function(){var n,k,m;n=angular.element;k=angular.module("validator.directive",[]);m=function(k){return{restrict:"A",require:"ngModel",link:function(g,m,d){var f,h,p,r,a,e,b,l;f=k.get("$validator");p=k.get("$parse")(d.ngModel);a=[];e=function(b,c){var e,f,l,h,k;null==c&&(c={success:function(){},error:function(){}});f=0;k=[];l=0;for(h=a.length;l<h;l++){e=a[l];switch(b){case "blur":if("blur"!==e.invoke)continue;e.enableError=!0;break;case "watch":if("watch"!==e.invoke&&!e.enableError)continue;break;
case "broadcast":e.enableError=!0}p.assign(g,e.filter(p(g)));k.push(e.validator(p(g),g,m,d,{success:function(){if(++f===a.length)return e.success(m,d),c.success()},error:function(){e.enableError&&e.error(m,d);return c.error()}}))}return k};if(h=d.validator.match(/^\/(.*)\/$/))h=f.convertRule("dynamic",{validator:RegExp(h[1]),invoke:d.validatorInvoke,error:d.validatorError}),a.push(h);if(h=d.validator.match(/^\[(.*)\]$/))for(r=h[1].split(","),b=0,l=r.length;b<l;b++)h=r[b],a.push(f.getRule(h.trim()));
g.$on(f.broadcastChannel.prepare,function(e,c){if(!c.model||0===d.ngModel.indexOf(c.model))return c.accept()});g.$on(f.broadcastChannel.start,function(b,c){if(!c.model||0===d.ngModel.indexOf(c.model))return e("broadcast",{success:c.success,error:c.error})});g.$watch(d.ngModel,function(b,c){if(b!==c)return e("watch")});return n(m).bind("blur",function(){return g.$apply(function(){return e("blur")})})}}};m.$inject=["$injector"];k.directive("validator",m)}).call(this);
(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var n;n=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var k,m,q,g,s=this;q=m=k=null;this.rules={};this.broadcastChannel={prepare:"$validateStartPrepare",start:"$validateStartStart"};g=function(d){k=d;m=k.get("$q");return q=k.get("$timeout")};this.convertRule=function(d,f){var h,p,g,a;null==f&&(f={});a={name:d,enableError:"watch"===f.invoke,invoke:f.invoke,filter:f.filter,validator:f.validator,error:f.error,success:f.success};null==a.filter&&(a.filter=
function(e){return e});null==a.validator&&(a.validator=function(){return!0});null==a.error&&(a.error="");a.error.constructor===String&&(h=a.error,a.error=function(e){var b;for(b=n(e).parent();0!==b.length;){if(b.hasClass("form-group")){if(b.hasClass("has-error"))break;n(e).parent().append("<label class='control-label error'>"+h+"</label>");b.addClass("has-error");break}b=b.parent()}});null==a.success&&(a.success=function(e){var b,a,d,c;b=n(e).parent();for(e=[];0!==b.length;){if(b.hasClass("has-error")){b.removeClass("has-error");
c=b.find("label");a=0;for(d=c.length;a<d;a++)if(b=c[a],n(b).hasClass("error")){b.remove();break}break}e.push(b=b.parent())}return e});a.validator.constructor===RegExp?(g=a.validator,a.validator=function(a,b,d,f,c){return g.test(a)?"function"===typeof c.success?c.success():void 0:"function"===typeof c.error?c.error():void 0}):"function"===typeof a.validator&&(p=a.validator,a.validator=function(a,b,d,f,c){return m.all([p(a,b,d,f,k)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof c.success?
c.success():void 0:"function"===typeof c.error?c.error():void 0})});return a};this.register=function(d,f){null==f&&(f={});return this.rules[d]=this.convertRule(d,f)};this.getRule=function(d){return this.rules[d]?this.rules[d]:null};this.validate=function(d,f){var h,g,n,a,e,b,l;l=m.defer().promise;e=a=n=0;h=[];g=[];l.success=function(a){h.push(a);return l};l.error=function(a){g.push(a);return l};b={model:f,accept:function(){return n++},success:function(){var b,c,d;if(++a===n)for(c=0,d=h.length;c<d;c++)b=
h[c],b()},error:function(){var a,c,b;if(0===e++)for(c=0,b=g.length;c<b;c++)a=g[c],a()}};d.$broadcast(s.broadcastChannel.prepare,b);q(function(){var a;a=k.get("$validator");return d.$broadcast(a.broadcastChannel.start,b)});return l};this.get=function(d){g(d);return{rules:this.rules,broadcastChannel:this.broadcastChannel,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
