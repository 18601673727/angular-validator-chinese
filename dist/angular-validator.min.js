(function(){var p,g,q;p=angular.element;g=angular.module("validator.directive",["validator.provider"]);q=function(g){return{restrict:"A",require:"ngModel",link:function(h,d,c){var b,a,m,f,e,k,l,n;b=g.get("$validator");m=g.get("$parse")(c.ngModel);e=[];k=function(b,a){var n,k,f,g,l;k=0;l=[];f=0;for(g=e.length;f<g;f++){n=e[f];switch(b){case "blur":if("blur"!==n.invoke)continue;n.enableError=!0;break;case "watch":if("watch"!==n.invoke&&!n.enableError)continue;break;case "broadcast":n.enableError=!0}m.assign(h,
n.filter(m(h)));l.push(n.validator(m(h),h,d,c,{success:function(){if(++k===e.length)return n.success(h,d,c),null!=a?a.success():void 0},error:function(){n.enableError&&n.error(h,d,c);if(1===(null!=a?a.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(d).offset().top-100},500):d[0].scrollIntoViewIfNeeded()}}))}return l};if(a=c.validator.match(/^\/(.*)\/$/))f=b.convertRule("dynamic",{validator:RegExp(a[1]),invoke:c.validatorInvoke,error:c.validatorError}),e.push(f);
if(a=c.validator.match(/^\[(.*)\]$/))for(a=a[1].split(","),l=0,n=a.length;l<n;l++)f=a[l],(f=b.getRule(f.trim()))&&e.push(f);h.$on(b.broadcastChannel.prepare,function(b,a){if(!a.model||0===c.ngModel.indexOf(a.model))return a.accept()});h.$on(b.broadcastChannel.start,function(b,a){if(!a.model||0===c.ngModel.indexOf(a.model))return k("broadcast",{success:a.success,error:a.error})});h.$watch(c.ngModel,function(a,b){if(a!==b)return k("watch")});return p(d).bind("blur",function(){return h.$apply(function(){return k("blur")})})}}};
q.$inject=["$injector"];g.directive("validator",q)}).call(this);(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var p;p=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var g,q,r,h=this;r=q=g=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart"};this.setupProviders=function(d){g=d;q=g.get("$q");return r=g.get("$timeout")};this.convertError=function(d){var c;if("function"===typeof d)return d;c=d.constructor===String?d:"";return function(b,a,d){for(b=p(a).parent();0!==b.length;){if(b.hasClass("form-group")){if(b.hasClass("has-error"))break;
d.id?p(a).parent().append("<label for='"+d.id+"' class='control-label error'>"+c+"</label>"):p(a).parent().append("<label class='control-label error'>"+c+"</label>");b.addClass("has-error");break}b=b.parent()}}};this.convertSuccess=function(d){return"function"===typeof d?d:function(d,b){var a,m,f,e,k;a=p(b).parent();for(k=[];0!==a.length;){if(a.hasClass("has-error")){a.removeClass("has-error");e=a.find("label");m=0;for(f=e.length;m<f;m++)if(a=e[m],p(a).hasClass("error")){a.remove();break}break}k.push(a=
a.parent())}return k}};this.convertValidator=function(d){var c;c=function(){};d.constructor===RegExp?c=function(b,a,c,f,e){return d.test(b)?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0}:"function"===typeof d&&(c=function(b,a,c,f,e){return q.all([d(b,a,c,f,g)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0},function(){return"function"===typeof e.error?e.error():
void 0})});return c};this.convertRule=function(d,c){var b;null==c&&(c={});b={name:d,enableError:"watch"===c.invoke,invoke:c.invoke,filter:c.filter,validator:c.validator,error:c.error,success:c.success};null==b.filter&&(b.filter=function(a){return a});null==b.validator&&(b.validator=function(){return!0});null==b.error&&(b.error="");b.error=h.convertError(b.error);b.success=h.convertSuccess(b.success);b.validator=h.convertValidator(b.validator);return b};this.register=function(d,c){null==c&&(c={});
return this.rules[d]=this.convertRule(d,c)};this.getRule=function(d){return this.rules[d]?this.rules[d]:null};this.validate=function(d,c){var b,a,m,f,e,k,l;l=q.defer().promise;e=f=m=0;b=[];a=[];l.success=function(a){b.push(a);return l};l.error=function(b){a.push(b);return l};k={model:c,accept:function(){return m++},success:function(){var a,d,c;if(++f===m)for(d=0,c=b.length;d<c;d++)a=b[d],a()},error:function(){var b,d,c;if(0===e++)for(d=0,c=a.length;d<c;d++)b=a[d],b();return e}};d.$broadcast(h.broadcastChannel.prepare,
k);r(function(){var a,c,e;if(0===m)for(c=0,e=b.length;c<e;c++)a=b[c],a();else return a=g.get("$validator"),d.$broadcast(a.broadcastChannel.start,k)});return l};this.get=function(d){this.setupProviders(d);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
