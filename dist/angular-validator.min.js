(function(){var h,n;h=angular.module("validator.directive",[]);n=function(l){return{restrict:"A",require:"ngModel",link:function(g,h,d){var p,b,q,e,r,a,k,m;p=l.get("$validator");q=l.get("$parse")(d.ngModel);r=[];a=function(a,c){var b,m,e,k,l;null==c&&(c={success:function(){},error:function(){}});m=0;l=[];e=0;for(k=r.length;e<k;e++)b=r[e],"broadcast"===a&&(b.enableError=!0),q.assign(g,b.filter(q(g))),l.push(b.validator(q(g),h,d,{success:function(){if(++m===r.length)return c.success()},error:function(){return c.error()}}));
return l};if(b=d.validator.match(/^\/(.*)\/$/))b=p.convertRule({validator:RegExp(b[1]),invoke:d.validatorInvoke,error:d.validatorError}),r.push(b);if(b=d.validator.match(/^\[(.*)\]$/))for(e=b[1].split(","),k=0,m=e.length;k<m;k++)b=e[k],r.push(p.getRule(b.trim()));g.$on(p.broadcastChannel.prepare,function(a,c){if(!c.model||0===d.ngModel.indexOf(c.model))return c.accept()});g.$on(p.broadcastChannel.start,function(b,c){if(!c.model||0===d.ngModel.indexOf(c.model))return a("broadcast",{success:c.success,
error:c.error})});return g.$watch(d.ngModel,function(b,c){if(b!==c)return a()})}}};n.$inject=["$injector"];h.directive("validator",n)}).call(this);(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var h,n=[].indexOf||function(l){for(var g=0,h=this.length;g<h;g++)if(g in this&&this[g]===l)return g;return-1};h=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var l,g,s,d,p=this;g=l=null;this.rules={};this.broadcastChannel={prepare:"$validateStartPrepare",start:"$validateStartStart"};s={all:function(){for(var b in this)if("all"!==b)this[b]()}};d=function(b){l=b;return g=l.get("$q")};this.convertRule=function(b){var q,e,d,a,k;null==b&&(b={});a=
{enableError:!1,invoke:b.invoke,filter:b.filter,validator:b.validator,error:b.error,success:b.success};null==a.invoke&&(a.invoke=[]);a.invoke.constructor===String&&(a.invoke=a.invoke.split(","));null==a.filter&&(a.filter=function(a){return a});null==a.validator&&(a.validator=function(){return!0});null==a.error&&(a.error="");a.enableError=0<=n.call(a.invoke,"watch");a.error.constructor===String&&(q=a.error,a.error=function(a,b){var c,f;c=h(a).parent();for(f=1;3>=f;++f){if(c.hasClass("form-group")){if(c.hasClass("has-error"))break;
h(a).parent().append("<label class='control-label error'>"+q+"</label>");c.addClass("has-error");break}c=c.parent()}});k=function(a,b){var c,f,g,e,d;c=h(a).parent();d=[];for(f=1;3>=f;++f){if(c.hasClass("has-error")){c.removeClass("has-error");e=c.find("label");f=0;for(g=e.length;f<g;f++)if(c=e[f],h(c).hasClass("error")){c.remove();break}break}d.push(c=c.parent())}return d};a.success&&"function"===typeof a.success?(e=a.success,a.success=function(a,b){e(a,b);return k(a,b)}):a.success=k;a.validator.constructor===
RegExp?(d=a.validator,a.validator=function(b,e,c,f){if(d.test(b))return a.success(e,c),"function"===typeof f.success?f.success():void 0;a.enableError&&a.error(e,c);return"function"===typeof f.error?f.error():void 0}):"function"===typeof a.validator&&(e=a.validator,a.validator=function(b,d,c,f){return g.all([e(b,d,c,l)]).then(function(b){if(b&&0<b.length&&b[0])return a.success(d,c),"function"===typeof f.success?f.success():void 0;a.enableError&&a.error(d,c);return"function"===typeof f.error?f.error():
void 0})});return a};this.register=function(b,d){null==d&&(d={});return this.rules[b]=this.convertRule(d)};this.getRule=function(b){return this.rules[b]?this.rules[b]:null};this.validate=function(b,d){var e,h,a,k,m,n;n=g.defer().promise;a=h=e=0;m={success:function(){},error:function(){},accept:function(){return e++},validatedSuccess:function(){if(++h===e)return m.success()},validatedError:function(){if(0===a++)return m.error()}};n.success=function(a){return m.success=a};n.error=function(a){return m.error=
a};k={model:d,accept:m.accept,success:m.validatedSuccess,error:m.validatedError};b.$broadcast(p.broadcastChannel.prepare,k);setTimeout(function(){return b.$apply(function(){var a;a=l.get("$validator");return b.$broadcast(a.broadcastChannel.start,k)})},0);return n};this.get=function(b){d(b);s.all();return{rules:this.rules,broadcastChannel:this.broadcastChannel,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
