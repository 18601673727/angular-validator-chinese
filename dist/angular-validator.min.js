(function(){var n,h,p;n=angular.element;h=angular.module("validator.directive",[]);p=function(h){return{restrict:"A",require:"ngModel",link:function(k,b,d){var c,a,m,g,f,e,l,q;c=h.get("$validator");m=h.get("$parse")(d.ngModel);f=[];e=function(c,a){var e,g,q,h,l;null==a&&(a={success:function(){},error:function(){}});g=0;l=[];q=0;for(h=f.length;q<h;q++){e=f[q];switch(c){case "blur":if("blur"!==e.invoke)continue;e.enableError=!0;break;case "watch":if("watch"!==e.invoke&&!e.enableError)continue;break;
case "broadcast":e.enableError=!0}m.assign(k,e.filter(m(k)));l.push(e.validator(m(k),k,b,d,{success:function(){if(++g===f.length)return e.success(k,b,d),a.success()},error:function(){e.enableError&&e.error(k,b,d);return a.error()}}))}return l};if(a=d.validator.match(/^\/(.*)\/$/))g=c.convertRule("dynamic",{validator:RegExp(a[1]),invoke:d.validatorInvoke,error:d.validatorError}),f.push(g);if(a=d.validator.match(/^\[(.*)\]$/))for(a=a[1].split(","),l=0,q=a.length;l<q;l++)g=a[l],(g=c.getRule(g.trim()))&&
f.push(g);k.$on(c.broadcastChannel.prepare,function(a,c){if(!c.model||0===d.ngModel.indexOf(c.model))return c.accept()});k.$on(c.broadcastChannel.start,function(c,a){if(!a.model||0===d.ngModel.indexOf(a.model))return e("broadcast",{success:a.success,error:a.error})});k.$watch(d.ngModel,function(a,c){if(a!==c)return e("watch")});return n(b).bind("blur",function(){return k.$apply(function(){return e("blur")})})}}};p.$inject=["$injector"];h.directive("validator",p)}).call(this);
(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var n;n=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var h,p,r,k=this;r=p=h=null;this.rules={};this.broadcastChannel={prepare:"$validateStartPrepare",start:"$validateStartStart"};this.setupProviders=function(b){h=b;p=h.get("$q");return r=h.get("$timeout")};this.convertError=function(b){var d;if("function"===typeof b)return b;d=b.constructor===String?b:"";return function(c,a){var b;for(b=n(a).parent();0!==b.length;){if(b.hasClass("form-group")){if(b.hasClass("has-error"))break;
n(a).parent().append("<label class='control-label error'>"+d+"</label>");b.addClass("has-error");break}b=b.parent()}}};this.convertSuccess=function(b){return"function"===typeof b?b:function(b,c){var a,m,g,f,e;a=n(c).parent();for(e=[];0!==a.length;){if(a.hasClass("has-error")){a.removeClass("has-error");f=a.find("label");m=0;for(g=f.length;m<g;m++)if(a=f[m],n(a).hasClass("error")){a.remove();break}break}e.push(a=a.parent())}return e}};this.convertValidator=function(b){var d;d=function(){};b.constructor===
RegExp?d=function(c,a,d,g,f){return b.test(c)?"function"===typeof f.success?f.success():void 0:"function"===typeof f.error?f.error():void 0}:"function"===typeof b&&(d=function(c,a,d,g,f){return p.all([b(c,a,d,g,h)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof f.success?f.success():void 0:"function"===typeof f.error?f.error():void 0})});return d};this.convertRule=function(b,d){var c;null==d&&(d={});c={name:b,enableError:"watch"===d.invoke,invoke:d.invoke,filter:d.filter,validator:d.validator,
error:d.error,success:d.success};null==c.filter&&(c.filter=function(a){return a});null==c.validator&&(c.validator=function(){return!0});null==c.error&&(c.error="");c.error=k.convertError(c.error);c.success=k.convertSuccess(c.success);c.validator=k.convertValidator(c.validator);return c};this.register=function(b,d){null==d&&(d={});return this.rules[b]=this.convertRule(b,d)};this.getRule=function(b){return this.rules[b]?this.rules[b]:null};this.validate=function(b,d){var c,a,m,g,f,e,l;l=p.defer().promise;
f=g=m=0;c=[];a=[];l.success=function(a){c.push(a);return l};l.error=function(b){a.push(b);return l};e={model:d,accept:function(){return m++},success:function(){var a,b,d;if(++g===m)for(b=0,d=c.length;b<d;b++)a=c[b],a()},error:function(){var b,c,d;if(0===f++)for(c=0,d=a.length;c<d;c++)b=a[c],b()}};b.$broadcast(k.broadcastChannel.prepare,e);r(function(){var a;a=h.get("$validator");return b.$broadcast(a.broadcastChannel.start,e)});return l};this.get=function(b){this.setupProviders(b);return{rules:this.rules,
broadcastChannel:this.broadcastChannel,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
