(function(){var m,n,q;m=angular.element;n=angular.module("validator.directive",["validator.provider"]);q=function(n){return{restrict:"A",require:"ngModel",link:function(l,d,c){var b,f,g,a,e,h,k,p,r;b=n.get("$validator");g=n.get("$parse")(c.ngModel);h=[];k=function(b,f){var a,e,p,r,k;e=0;k=[];p=0;for(r=h.length;p<r;p++){a=h[p];switch(b){case "blur":if("blur"!==a.invoke)continue;a.enableError=!0;break;case "watch":if("watch"!==a.invoke&&!a.enableError)continue;break;case "broadcast":a.enableError=!0}g.assign(l,
a.filter(g(l)));k.push(a.validator(g(l),l,d,c,{success:function(){if(++e===h.length)return a.success(l,d,c),null!=f?f.success():void 0},error:function(){a.enableError&&a.error(l,d,c);if(1===(null!=f?f.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(d).offset().top-100},500):d[0].scrollIntoViewIfNeeded()}}))}return k};if(f=c.validator.match(/^\/(.*)\/$/))a=b.convertRule("dynamic",{validator:RegExp(f[1]),invoke:c.validatorInvoke,error:c.validatorError}),h.push(a);
if(f=c.validator.match(/^\[(.*)\]$/))for(e=f[1].split(","),p=0,r=e.length;p<r;p++)f=e[p],(a=b.getRule(f.replace(/^\s+|\s+$/g,"")))&&h.push(a);l.$on(b.broadcastChannel.prepare,function(a,b){if(!b.model||0===c.ngModel.indexOf(b.model))return b.accept()});l.$on(b.broadcastChannel.start,function(b,a){if(!a.model||0===c.ngModel.indexOf(a.model))return k("broadcast",{success:a.success,error:a.error})});l.$on(b.broadcastChannel.reset,function(b,f){var e,p,g;if(!f.model||0===c.ngModel.indexOf(f.model)){g=
[];e=0;for(p=h.length;e<p;e++)a=h[e],g.push(a.success(l,d,c));return g}});l.$watch(c.ngModel,function(a,b){if(a!==b)return k("watch")});return m(d).bind("blur",function(){return l.$apply(function(){return k("blur")})})}}};q.$inject=["$injector"];n.directive("validator",q)}).call(this);(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var m;m=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var n,q,s,l=this;s=q=n=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart",reset:"$validateReset"};this.setupProviders=function(d){n=d;q=n.get("$q");return s=n.get("$timeout")};this.convertError=function(d){var c;if("function"===typeof d)return d;c=d.constructor===String?d:"";return function(b,f,d){var a,e,h,k;a=m(f).parent();for(b=[];0!==a.length;){if(a.hasClass("form-group")){a.addClass("has-error");
k=a.find("label");e=0;for(h=k.length;e<h;e++)a=k[e],m(a).hasClass("error")&&m(a).remove();a=m("<label class='control-label error'>"+c+"</label>");d.id&&a.attr("for",d.id);m(f).parent().append(a);break}b.push(a=a.parent())}return b}};this.convertSuccess=function(d){return"function"===typeof d?d:function(d,b){var f,g,a,e,h;f=m(b).parent();for(h=[];0!==f.length;){if(f.hasClass("has-error")){f.removeClass("has-error");e=f.find("label");g=0;for(a=e.length;g<a;g++)f=e[g],m(f).hasClass("error")&&m(f).remove();
break}h.push(f=f.parent())}return h}};this.convertValidator=function(d){var c;c=function(){};d.constructor===RegExp?c=function(b,c,g,a,e){return d.test(b)?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0}:"function"===typeof d&&(c=function(b,c,g,a,e){return q.all([d(b,c,g,a,n)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0},function(){return"function"===typeof e.error?
e.error():void 0})});return c};this.convertRule=function(d,c){var b;null==c&&(c={});b={name:d,enableError:"watch"===c.invoke,invoke:c.invoke,filter:c.filter,validator:c.validator,error:c.error,success:c.success};null==b.filter&&(b.filter=function(b){return b});null==b.validator&&(b.validator=function(){return!0});null==b.error&&(b.error="");b.error=l.convertError(b.error);b.success=l.convertSuccess(b.success);b.validator=l.convertValidator(b.validator);return b};this.register=function(d,c){null==
c&&(c={});return this.rules[d]=this.convertRule(d,c)};this.getRule=function(d){return this.rules[d]?this.rules[d]:null};this.validate=function(d,c){var b,f,g,a,e,h,k;k=q.defer().promise;e=a=g=0;b=[];f=[];k.success=function(a){b.push(a);return k};k.error=function(a){f.push(a);return k};h={model:c,accept:function(){return g++},success:function(){var d,c,e;if(++a===g)for(c=0,e=b.length;c<e;c++)d=b[c],d()},error:function(){var a,b,c;if(0===e++)for(b=0,c=f.length;b<c;b++)a=f[b],a();return e}};d.$broadcast(l.broadcastChannel.prepare,
h);s(function(){var a,c,e;if(0===g)for(c=0,e=b.length;c<e;c++)a=b[c],a();else return a=n.get("$validator"),d.$broadcast(a.broadcastChannel.start,h)});return k};this.reset=function(d,c){return d.$broadcast(l.broadcastChannel.reset,{model:c})};this.get=function(d){this.setupProviders(d);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate,reset:this.reset}};this.get.$inject=["$injector"];return this.$get=
this.get})}).call(this);
