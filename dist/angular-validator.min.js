(function(){var g,m,p;g=angular.element;m=angular.module("validator.directive",["validator.provider"]);p=function(m){return{restrict:"A",require:"ngModel",link:function(l,d,c){var a,e,n,b,f,h,k,q;a=m.get("$validator");n=m.get("$parse")(c.ngModel);f=[];h=function(a,e){var b,h,q,k,g;h=0;g=[];q=0;for(k=f.length;q<k;q++){b=f[q];switch(a){case "blur":if("blur"!==b.invoke)continue;b.enableError=!0;break;case "watch":if("watch"!==b.invoke&&!b.enableError)continue;break;case "broadcast":b.enableError=!0}n.assign(l,
b.filter(n(l)));g.push(b.validator(n(l),l,d,c,{success:function(){if(++h===f.length)return b.success(l,d,c),null!=e?e.success():void 0},error:function(){b.enableError&&b.error(l,d,c);if(1===(null!=e?e.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(d).offset().top-100},500):d[0].scrollIntoViewIfNeeded()}}))}return g};if(e=c.validator.match(/^\/(.*)\/$/))b=a.convertRule("dynamic",{validator:RegExp(e[1]),invoke:c.validatorInvoke,error:c.validatorError}),f.push(b);
if(e=c.validator.match(/^\[(.*)\]$/))for(e=e[1].split(","),k=0,q=e.length;k<q;k++)b=e[k],(b=a.getRule(b.replace(/^\s+|\s+$/g,"")))&&f.push(b);l.$on(a.broadcastChannel.prepare,function(a,b){if(!b.model||0===c.ngModel.indexOf(b.model))return b.accept()});l.$on(a.broadcastChannel.start,function(b,a){if(!a.model||0===c.ngModel.indexOf(a.model))return h("broadcast",{success:a.success,error:a.error})});l.$watch(c.ngModel,function(a,b){if(a!==b)return h("watch")});return g(d).bind("blur",function(){return l.$apply(function(){return h("blur")})})}}};
p.$inject=["$injector"];m.directive("validator",p)}).call(this);(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var g;g=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var m,p,r,l=this;r=p=m=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart"};this.setupProviders=function(d){m=d;p=m.get("$q");return r=m.get("$timeout")};this.convertError=function(d){var c;if("function"===typeof d)return d;c=d.constructor===String?d:"";return function(a,e,d){var b,f,h,k;b=g(e).parent();for(a=[];0!==b.length;){if(b.hasClass("form-group")){b.addClass("has-error");
k=b.find("label");f=0;for(h=k.length;f<h;f++)b=k[f],g(b).hasClass("error")&&g(b).remove();d.id?g(e).parent().append("<label for='"+d.id+"' class='control-label error'>"+c+"</label>"):g(e).parent().append("<label class='control-label error'>"+c+"</label>");break}a.push(b=b.parent())}return a}};this.convertSuccess=function(d){return"function"===typeof d?d:function(d,a){var e,n,b,f,h;e=g(a).parent();for(h=[];0!==e.length;){if(e.hasClass("has-error")){e.removeClass("has-error");f=e.find("label");n=0;
for(b=f.length;n<b;n++)e=f[n],g(e).hasClass("error")&&g(e).remove();break}h.push(e=e.parent())}return h}};this.convertValidator=function(d){var c;c=function(){};d.constructor===RegExp?c=function(a,e,c,b,f){return d.test(a)?"function"===typeof f.success?f.success():void 0:"function"===typeof f.error?f.error():void 0}:"function"===typeof d&&(c=function(a,e,c,b,f){return p.all([d(a,e,c,b,m)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof f.success?f.success():void 0:"function"===typeof f.error?
f.error():void 0},function(){return"function"===typeof f.error?f.error():void 0})});return c};this.convertRule=function(d,c){var a;null==c&&(c={});a={name:d,enableError:"watch"===c.invoke,invoke:c.invoke,filter:c.filter,validator:c.validator,error:c.error,success:c.success};null==a.filter&&(a.filter=function(a){return a});null==a.validator&&(a.validator=function(){return!0});null==a.error&&(a.error="");a.error=l.convertError(a.error);a.success=l.convertSuccess(a.success);a.validator=l.convertValidator(a.validator);
return a};this.register=function(d,c){null==c&&(c={});return this.rules[d]=this.convertRule(d,c)};this.getRule=function(d){return this.rules[d]?this.rules[d]:null};this.validate=function(d,c){var a,e,g,b,f,h,k;k=p.defer().promise;f=b=g=0;a=[];e=[];k.success=function(b){a.push(b);return k};k.error=function(a){e.push(a);return k};h={model:c,accept:function(){return g++},success:function(){var d,c,e;if(++b===g)for(c=0,e=a.length;c<e;c++)d=a[c],d()},error:function(){var a,b,c;if(0===f++)for(b=0,c=e.length;b<
c;b++)a=e[b],a();return f}};d.$broadcast(l.broadcastChannel.prepare,h);r(function(){var b,c,e;if(0===g)for(c=0,e=a.length;c<e;c++)b=a[c],b();else return b=m.get("$validator"),d.$broadcast(b.broadcastChannel.start,h)});return k};this.get=function(d){this.setupProviders(d);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
