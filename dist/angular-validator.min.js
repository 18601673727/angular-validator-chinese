(function(){var p,g,q;p=angular.element;g=angular.module("validator.directive",["validator.provider"]);q=function(g){return{restrict:"A",require:"ngModel",link:function(h,b,d){var a,c,m,f,e,k,l,n;a=g.get("$validator");m=g.get("$parse")(d.ngModel);e=[];k=function(a,c){var n,k,f,g,l;k=0;l=[];f=0;for(g=e.length;f<g;f++){n=e[f];switch(a){case "blur":if("blur"!==n.invoke)continue;n.enableError=!0;break;case "watch":if("watch"!==n.invoke&&!n.enableError)continue;break;case "broadcast":n.enableError=!0}m.assign(h,
n.filter(m(h)));l.push(n.validator(m(h),h,b,d,{success:function(){if(++k===e.length)return n.success(h,b,d),null!=c?c.success():void 0},error:function(){n.enableError&&n.error(h,b,d);if(1===(null!=c?c.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(b).offset().top-100},500):b[0].scrollIntoViewIfNeeded()}}))}return l};if(c=d.validator.match(/^\/(.*)\/$/))f=a.convertRule("dynamic",{validator:RegExp(c[1]),invoke:d.validatorInvoke,error:d.validatorError}),e.push(f);
if(c=d.validator.match(/^\[(.*)\]$/))for(c=c[1].split(","),l=0,n=c.length;l<n;l++)f=c[l],(f=a.getRule(f.trim()))&&e.push(f);h.$on(a.broadcastChannel.prepare,function(a,c){if(!c.model||0===d.ngModel.indexOf(c.model))return c.accept()});h.$on(a.broadcastChannel.start,function(c,a){if(!a.model||0===d.ngModel.indexOf(a.model))return k("broadcast",{success:a.success,error:a.error})});h.$watch(d.ngModel,function(a,c){if(a!==c)return k("watch")});return p(b).bind("blur",function(){return h.$apply(function(){return k("blur")})})}}};
q.$inject=["$injector"];g.directive("validator",q)}).call(this);(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var p;p=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var g,q,r,h=this;r=q=g=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart"};this.setupProviders=function(b){g=b;q=g.get("$q");return r=g.get("$timeout")};this.convertError=function(b){var d;if("function"===typeof b)return b;d=b.constructor===String?b:"";return function(a,c){var b;for(b=p(c).parent();0!==b.length;){if(b.hasClass("form-group")){if(b.hasClass("has-error"))break;
p(c).parent().append("<label class='control-label error'>"+d+"</label>");b.addClass("has-error");break}b=b.parent()}}};this.convertSuccess=function(b){return"function"===typeof b?b:function(b,a){var c,m,f,e,k;c=p(a).parent();for(k=[];0!==c.length;){if(c.hasClass("has-error")){c.removeClass("has-error");e=c.find("label");m=0;for(f=e.length;m<f;m++)if(c=e[m],p(c).hasClass("error")){c.remove();break}break}k.push(c=c.parent())}return k}};this.convertValidator=function(b){var d;d=function(){};b.constructor===
RegExp?d=function(a,c,d,f,e){return b.test(a)?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0}:"function"===typeof b&&(d=function(a,c,d,f,e){return q.all([b(a,c,d,f,g)]).then(function(a){return a&&0<a.length&&a[0]?"function"===typeof e.success?e.success():void 0:"function"===typeof e.error?e.error():void 0},function(){return"function"===typeof e.error?e.error():void 0})});return d};this.convertRule=function(b,d){var a;null==d&&(d={});a={name:b,enableError:"watch"===
d.invoke,invoke:d.invoke,filter:d.filter,validator:d.validator,error:d.error,success:d.success};null==a.filter&&(a.filter=function(a){return a});null==a.validator&&(a.validator=function(){return!0});null==a.error&&(a.error="");a.error=h.convertError(a.error);a.success=h.convertSuccess(a.success);a.validator=h.convertValidator(a.validator);return a};this.register=function(b,d){null==d&&(d={});return this.rules[b]=this.convertRule(b,d)};this.getRule=function(b){return this.rules[b]?this.rules[b]:null};
this.validate=function(b,d){var a,c,m,f,e,k,l;l=q.defer().promise;e=f=m=0;a=[];c=[];l.success=function(b){a.push(b);return l};l.error=function(a){c.push(a);return l};k={model:d,accept:function(){return m++},success:function(){var b,c,d;if(++f===m)for(c=0,d=a.length;c<d;c++)b=a[c],b()},error:function(){var a,b,d;if(0===e++)for(b=0,d=c.length;b<d;b++)a=c[b],a();return e}};b.$broadcast(h.broadcastChannel.prepare,k);r(function(){var c,d,e;if(0===m)for(d=0,e=a.length;d<e;d++)c=a[d],c();else return c=g.get("$validator"),
b.$broadcast(c.broadcastChannel.start,k)});return l};this.get=function(b){this.setupProviders(b);return{rules:this.rules,broadcastChannel:this.broadcastChannel,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate}};this.get.$inject=["$injector"];return this.$get=this.get})}).call(this);
