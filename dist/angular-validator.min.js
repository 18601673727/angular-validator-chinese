(function(){var m,n,p;m=angular.element;n=angular.module("validator.directive",["validator.provider"]);p=function(n){return{restrict:"A",require:"ngModel",link:function(g,c,d){var b,e,h,f,a,k,l,r,q,s,p;b=n.get("$validator");f=n.get("$parse")(d.ngModel);r=[];q=function(b,e){var a,h,k,q,l;h=0;l=[];k=0;for(q=r.length;k<q;k++){a=r[k];switch(b){case "blur":if("blur"!==a.invoke)continue;a.enableError=!0;break;case "watch":if("watch"!==a.invoke&&!a.enableError)continue;break;case "broadcast":a.enableError=
!0}f.assign(g,a.filter(f(g)));l.push(a.validator(f(g),g,c,d,{success:function(){if(++h===r.length)return a.success(g,c,d),null!=e?e.success():void 0},error:function(){a.enableError&&a.error(g,c,d);if(1===(null!=e?e.error():void 0))return window.jQuery?jQuery("html, body").animate({scrollTop:jQuery(c).offset().top-100},500):c[0].scrollIntoViewIfNeeded()}}))}return l};if(h=d.validator.match(/^\/(.*)\/$/))k=b.convertRule("dynamic",{validator:RegExp(h[1]),invoke:d.validatorInvoke,error:d.validatorError}),
r.push(k);if(h=d.validator.match(/^\[(.*)\]$/))for(l=h[1].split(","),s=0,p=l.length;s<p;s++)a=l[s],(k=b.getRule(a.replace(/^\s+|\s+$/g,"")))&&r.push(k);e=function(b,a){var e,f;if(a){if(b.targetScope===g)return 0===d.ngModel.indexOf(a);for(e=m(c);0!==e.length;){f=e.attr("ng-repeat");if((h=null!=f?f.match(/^.* in (.*)$/):void 0)&&0<=h[1].indexOf(a))return!0;e=e.parent()}return!1}return!0};g.$on(b.broadcastChannel.prepare,function(a,b){if(e(a,b.model))return b.accept()});g.$on(b.broadcastChannel.start,
function(b,a){if(e(b,a.model))return q("broadcast",{success:a.success,error:a.error})});g.$on(b.broadcastChannel.reset,function(a,b){var f,h,q;if(e(a,b.model)){q=[];f=0;for(h=r.length;f<h;f++)k=r[f],q.push(k.success(g,c,d));return q}});g.$watch(d.ngModel,function(a,b){if(a!==b)return q("watch")});return m(c).bind("blur",function(){return g.$apply(function(){return q("blur")})})}}};p.$inject=["$injector"];n.directive("validator",p)}).call(this);
(function(){angular.module("validator",["validator.provider","validator.directive"])}).call(this);
(function(){var m;m=angular.element;angular.module("validator.provider",[]).provider("$validator",function(){var n,p,t,g=this;t=p=n=null;this.rules={};this.broadcastChannel={prepare:"$validatePrepare",start:"$validateStart",reset:"$validateReset"};this.setupProviders=function(c){n=c;p=n.get("$q");return t=n.get("$timeout")};this.convertError=function(c){var d;if("function"===typeof c)return c;d=c.constructor===String?c:"";return function(b,e,c){var f,a,k,g;f=m(e).parent();for(b=[];0!==f.length;){if(f.hasClass("form-group")){f.addClass("has-error");
g=f.find("label");a=0;for(k=g.length;a<k;a++)f=g[a],m(f).hasClass("error")&&m(f).remove();f=m("<label class='control-label error'>"+d+"</label>");c.id&&f.attr("for",c.id);m(e).parent().append(f);break}b.push(f=f.parent())}return b}};this.convertSuccess=function(c){return"function"===typeof c?c:function(c,b){var e,h,f,a,k;e=m(b).parent();for(k=[];0!==e.length;){if(e.hasClass("has-error")){e.removeClass("has-error");a=e.find("label");h=0;for(f=a.length;h<f;h++)e=a[h],m(e).hasClass("error")&&m(e).remove();
break}k.push(e=e.parent())}return k}};this.convertValidator=function(c){var d;d=function(){};c.constructor===RegExp?d=function(b,e,d,f,a){return c.test(b)?"function"===typeof a.success?a.success():void 0:"function"===typeof a.error?a.error():void 0}:"function"===typeof c&&(d=function(b,e,d,f,a){return p.all([c(b,e,d,f,n)]).then(function(b){return b&&0<b.length&&b[0]?"function"===typeof a.success?a.success():void 0:"function"===typeof a.error?a.error():void 0},function(){return"function"===typeof a.error?
a.error():void 0})});return d};this.convertRule=function(c,d){var b;null==d&&(d={});b={name:c,enableError:"watch"===d.invoke,invoke:d.invoke,filter:d.filter,validator:d.validator,error:d.error,success:d.success};null==b.filter&&(b.filter=function(b){return b});null==b.validator&&(b.validator=function(){return!0});null==b.error&&(b.error="");b.error=g.convertError(b.error);b.success=g.convertSuccess(b.success);b.validator=g.convertValidator(b.validator);return b};this.register=function(c,d){null==
d&&(d={});return this.rules[c]=this.convertRule(c,d)};this.getRule=function(c){return this.rules[c]?this.rules[c]:null};this.validate=function(c,d){var b,e,h,f,a,k,l;l=p.defer().promise;a=f=h=0;b=[];e=[];l.success=function(a){b.push(a);return l};l.error=function(b){e.push(b);return l};k={model:d,accept:function(){return h++},success:function(){var a,c,d;if(++f===h)for(c=0,d=b.length;c<d;c++)a=b[c],a()},error:function(){var b,c,d;if(0===a++)for(c=0,d=e.length;c<d;c++)b=e[c],b();return a}};c.$broadcast(g.broadcastChannel.prepare,
k);t(function(){var a,d,e;if(0===h)for(d=0,e=b.length;d<e;d++)a=b[d],a();else return a=n.get("$validator"),c.$broadcast(a.broadcastChannel.start,k)});return l};this.reset=function(c,d){return c.$broadcast(g.broadcastChannel.reset,{model:d})};this.get=function(c){this.setupProviders(c);return{rules:this.rules,broadcastChannel:this.broadcastChannel,register:this.register,convertRule:this.convertRule,getRule:this.getRule,validate:this.validate,reset:this.reset}};this.get.$inject=["$injector"];return this.$get=
this.get})}).call(this);
